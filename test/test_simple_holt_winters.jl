@testset "simple_holt_winters function tests" begin

    x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]
    result = simple_holt_winters(x, 12, alpha=0.5, beta=0.5, gamma=nothing,
        seasonal="none", m=1, dotrend=true, doseasonal=false,
        l_start=[1.0], exponential=false, phi=1.0,
        b_start=[1.0], s_start=[0.0])

    @test result.SSE == 1.4539079507940755
    @test result.fitted == [2.0, 2.25, 2.8125, 3.640625, 4.64453125, 5.7353515625, 6.846923828125, 7.94097900390625, 9.002761840820312, 10.032962799072266, 11.039822578430176, 12.033296823501587]
    @test result.level == [1.0, 1.5, 2.125, 2.90625, 3.8203125, 4.822265625, 5.86767578125, 6.9234619140625, 7.970489501953125, 9.001380920410156, 10.016481399536133, 11.019911289215088, 12.016648411750793]
    @test result.trend == [1.0, 0.75, 0.6875, 0.734375, 0.82421875, 0.9130859375, 0.979248046875, 1.01751708984375, 1.0322723388671875, 1.0315818786621094, 1.023341178894043, 1.013385534286499, 1.0050613284111023]
    @test result.season == [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

    x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]
    result = simple_holt_winters(x, 12, alpha=0.5, beta=0.5, gamma=0.05,
        seasonal="none", m=2, dotrend=true, doseasonal=false,
        l_start=[1.0], exponential=false, phi=1.0,
        b_start=[1.0], s_start=[0.0, 0.0])
    x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]
    @test result.SSE == 1.4539079507940755
    @test result.fitted == [2.0, 2.25, 2.8125, 3.640625, 4.64453125, 5.7353515625, 6.846923828125, 7.94097900390625, 9.002761840820312, 10.032962799072266, 11.039822578430176, 12.033296823501587]
    @test result.level == [1.0, 1.5, 2.125, 2.90625, 3.8203125, 4.822265625, 5.86767578125, 6.9234619140625, 7.970489501953125, 9.001380920410156, 10.016481399536133, 11.019911289215088, 12.016648411750793]
    @test result.trend == [1.0, 0.75, 0.6875, 0.734375, 0.82421875, 0.9130859375, 0.979248046875, 1.01751708984375, 1.0322723388671875, 1.0315818786621094, 1.023341178894043, 1.013385534286499, 1.0050613284111023]
    @test result.season == [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]
    result = simple_holt_winters(x, 12, alpha=0.5, beta=0.5, gamma=0.05,
        seasonal="multiplicative", m=2, dotrend=true, doseasonal=false,
        l_start=[1.0], exponential=false, phi=1.0,
        b_start=[1.0], s_start=[0.0, 0.0])

    @test result.SSE == 1.4539079507940755
    @test result.fitted == [2.0, 2.25, 2.8125, 3.640625, 4.64453125, 5.7353515625, 6.846923828125, 7.94097900390625, 9.002761840820312, 10.032962799072266, 11.039822578430176, 12.033296823501587]
    @test result.level == [1.0, 1.5, 2.125, 2.90625, 3.8203125, 4.822265625, 5.86767578125, 6.9234619140625, 7.970489501953125, 9.001380920410156, 10.016481399536133, 11.019911289215088, 12.016648411750793]
    @test result.trend == [1.0, 0.75, 0.6875, 0.734375, 0.82421875, 0.9130859375, 0.979248046875, 1.01751708984375, 1.0322723388671875, 1.0315818786621094, 1.023341178894043, 1.013385534286499, 1.0050613284111023]
    @test result.season == [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

    x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 12.98, 11.0]

    result = simple_holt_winters(x, 12, alpha=0.5, beta=0.5, gamma=0.05,
        seasonal="additive", m=2, dotrend=true, doseasonal=false,
        l_start=[1.0], exponential=false, phi=1.0,
        b_start=[1.0], s_start=[0.0, 0.0])

    @test result.SSE == 1.4539079507940755
    @test result.fitted == [2.0, 2.25, 2.8125, 3.640625, 4.64453125, 5.7353515625, 6.846923828125, 7.94097900390625, 9.002761840820312, 10.032962799072266, 11.039822578430176, 12.033296823501587]
    @test result.level == [1.0, 1.5, 2.125, 2.90625, 3.8203125, 4.822265625, 5.86767578125, 6.9234619140625, 7.970489501953125, 9.001380920410156, 10.016481399536133, 11.019911289215088, 12.016648411750793]
    @test result.trend == [1.0, 0.75, 0.6875, 0.734375, 0.82421875, 0.9130859375, 0.979248046875, 1.01751708984375, 1.0322723388671875, 1.0315818786621094, 1.023341178894043, 1.013385534286499, 1.0050613284111023]
    @test result.season == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

    x = [112, 118, 132, 129, 121, 135, 148, 148, 136, 119, 104, 118, 115, 126, 141, 135]
    lenx = 16
    alpha = 0.2
    beta = false
    gamma = false
    phi = 1.0
    seasonal = "none"
    m = 1
    dotrend = false
    doseasonal = false
    exponential = false
    l_start = [112.0]
    b_start = [nothing]
    s_start = [0.0]
    result = simple_holt_winters(x, lenx, alpha=alpha, beta=beta, gamma=gamma, phi=phi, seasonal=seasonal, m=m, dotrend=dotrend, doseasonal=doseasonal, exponential=exponential, l_start=l_start, b_start=b_start, s_start=s_start)

    @test isapprox.(result.SSE, 3243.87496103893, rtol=1e-4)
    @test isapprox(result.fitted, [112.0, 112.0, 113.2, 116.96, 119.368, 119.6944, 122.75552, 127.804416, 131.8435328, 132.67482624, 129.939860992, 124.7518887936, 123.40151103488, 121.721208827904, 122.576967062323, 126.261573649859], rtol=1e-4)
    @test isapprox(result.level, [112.0, 112.0, 113.2, 116.96, 119.368, 119.6944, 122.75552, 127.804416, 131.8435328, 132.67482624, 129.939860992, 124.7518887936, 123.40151103488, 121.721208827904, 122.576967062323, 126.261573649859, 128.009258919887], rtol=1e-4)
    @test isapprox(result.trend, [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], rtol=1e-4)
    @test result.season == [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] .* 1.0
    @test result.phi == 1.0
end